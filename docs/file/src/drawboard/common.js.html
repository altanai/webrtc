<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/drawboard/common.js | webrtcdevelopment</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="webrtc based communication and collaboration client. Contains lot of experiments modules "><meta property="twitter:card" content="summary"><meta property="twitter:title" content="webrtcdevelopment"><meta property="twitter:description" content="webrtc based communication and collaboration client. Contains lot of experiments modules "></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/altanai/webrtc"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#scripts">scripts</a><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-CanvasRecorder">CanvasRecorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-GetRecorderType">GetRecorderType</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-GifRecorder">GifRecorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MRecordRTC">MRecordRTC</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-MediaStreamRecorder">MediaStreamRecorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RecordRTC">RecordRTC</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-RecordRTCConfiguration">RecordRTCConfiguration</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-StereoAudioRecorder">StereoAudioRecorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Whammy">Whammy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-WhammyRecorder">WhammyRecorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-createFileSharingDiv">createFileSharingDiv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-_turn.js">_turn.js</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#scripts-rtcconn">scripts/rtcconn</a><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Whammy">Whammy</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/drawboard/common.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/* ***********************************************
common 
*********************************************/

function fitToContainer(parent , canvas){
    try{
        /*  canvas.style.width =&apos;100%&apos;;
        canvas.style.height=&apos;100%&apos;;*/
        canvas.width  = parent.offsetWidth;
        canvas.height = parent.offsetHeight;
    }catch(e){
        console.log(e);
    }
}

function setContext(canv) {
    var ctx=null;
    try{ 
         ctx = canv.getContext(&apos;2d&apos;);
         ctx.lineWidth = lineWidth;
         ctx.strokeStyle = strokeStyle;
         ctx.fillStyle = fillStyle;
         ctx.font = font;
    }catch(e){
        console.error(&quot; canvas context not set &quot; , canv);
        console.error(e);
    }
    return ctx;
}

var mainCanvas  = document.getElementById(&quot;main-canvas&quot;);
var canvas  = document.getElementById(&quot;temp-canvas&quot;);
var context = setContext(mainCanvas);
var tempContext = setContext(canvas);
var parentBox = document.getElementById(&quot;drawBox&quot;);

console.log(&quot;Main Canvas : &quot; , mainCanvas , context);
console.log(&quot;Temp Canvas : &quot; , canvas , tempContext );


fitToContainer( parentBox , mainCanvas );
fitToContainer( parentBox , canvas );

if(document.getElementById(&quot;trashBtn&quot;)){
    document.getElementById(&quot;trashBtn&quot;).onclick = function() {
        tempContext.clearRect(0, 0, canvas.width, canvas.height);
        console.log(&quot; cleared temp canvas&quot; , canvas  );

        context.clearRect(0, 0, mainCanvas.width, mainCanvas.height);
        console.log(&quot; cleared main canvas &quot; , mainCanvas);

        window.location.reload();
    };
}else{
    console.error(&quot;trash button not found&quot;);
}


if(document.getElementById(&quot;saveBtn&quot;)){

    document.getElementById(&quot;saveBtn&quot;).onclick = function() {

        /*        
        var aref = document.createElement(&quot;a&quot;);
        aref.href = mainCanvas.toDataURL(&quot;image/png&quot;) ;
        aref.download = &quot;drawBox.png&quot;;
        aref.click();*/

        parent.postMessage({
            modalpopup : {
                filetype : &quot;blobcanvas&quot; ,   
            }, 
            sender: selfId
        }, &apos;*&apos;);

        /*document.getElementById(&quot;saveBtn&quot;).appendChild(aref);*/
        //window.open(mainCanvas.toDataURL(&quot;image/png&quot;) , &quot;canvasDiagram&quot;);
        /*var e = mainCanvas.toDataURL(&quot;image/png&quot;),
        a = window.open(&quot;about:blank&quot;, &quot;image from canvas&quot;);
        a.document.write(&quot;&lt;img src=&apos;&quot; + e + &quot;&apos; alt=&apos;from canvas&apos;/&gt;&quot;);*/
    };
}else{
    console.error(&quot;save button not found&quot;);
}

/*-----------------------------------------------*/

var is = {
    isLine: false,
    isArc: false,
    isDragLastPath: false,
    isDragAllPaths: false,
    isRectangle: false,
    isQuadraticCurve: false,
    isBezierCurve: false,
    isPencil: false,
    isEraser: false,
    isText: false,

    set: function(shape) {
        var cache = this;
        cache.isLine = cache.isArc = cache.isDragLastPath = cache.isDragAllPaths = cache.isRectangle = cache.isQuadraticCurve = cache.isBezierCurve = is.isPencil = is.isEraser = is.isText = false;
        cache[&apos;is&apos; + shape] = true;
    }
};


function addEvent(element, eventType, callback) {
    if (element.addEventListener) {
        element.addEventListener(eventType, callback, !1);
        return true;
    } else if (element.attachEvent) {
        return element.attachEvent(&apos;on&apos; + eventType, callback);
    } else {
        element[&apos;on&apos; + eventType] = callback;
    }
    return this;
}


function find(selector) {
    return document.getElementById(selector);
}


var points = [],
    textarea = find(&apos;code-text&apos;),
    lineWidth = 2,
    strokeStyle = &apos;#6c96c8&apos;,
    fillStyle = &apos;transparent&apos;,
    globalAlpha = 1,
    globalCompositeOperation = &apos;source-over&apos;,
    lineCap = &apos;butt&apos;,
    font = &apos;15px Verdana&apos;,
    lineJoin = &apos;miter&apos;;


var common = {

    updateTextArea: function() {
        var c = common,
            toFixed = c.toFixed,
            getPoint = c.getPoint,

            isAbsolutePoints = find(&apos;is-absolute-points&apos;).checked,
            isShortenCode = find(&apos;is-shorten-code&apos;).checked;

        if (isAbsolutePoints &amp;&amp; isShortenCode) c.absoluteShortened();
        if (isAbsolutePoints &amp;&amp; !isShortenCode) c.absoluteNOTShortened(toFixed);
        if (!isAbsolutePoints &amp;&amp; isShortenCode) c.relativeShortened(toFixed, getPoint);
        if (!isAbsolutePoints &amp;&amp; !isShortenCode) c.relativeNOTShortened(toFixed, getPoint);
    },



    toFixed: function(input) {
        return Number(input).toFixed(1);
    },



    getPoint: function(pointToCompare, compareWith, prefix) {
        if (pointToCompare &gt; compareWith) pointToCompare = prefix + &apos; + &apos; + (pointToCompare - compareWith);
        else if (pointToCompare &lt; compareWith) pointToCompare = prefix + &apos; - &apos; + (compareWith - pointToCompare);
        else pointToCompare = prefix;

        return pointToCompare;
    },



    absoluteShortened: function() {

        var output = &apos;&apos;,
            length = points.length,
            i = 0,
            point;
        for (i; i &lt; length; i++) {
            point = points[i];
            output += this.shortenHelper(point[0], point[1], point[2]);
        }

        output = output.substr(0, output.length - 2);
        textarea.value = &apos;var points = [&apos; + output + &apos;], length = points.length, point, p, i = 0;\n\n&apos; + this.forLoop;

        this.prevProps = null;
    },


    absoluteNOTShortened: function(toFixed) {
        var tempArray = [],
            i, point, p;

        for (i = 0; i &lt; points.length; i++) {
            p = points[i];
            point = p[1];

            if (p[0] === &apos;pencil&apos;) {
                tempArray[i] = [&apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;);\n&apos; + &apos;context.lineTo(&apos; + point[2] + &apos;, &apos; + point[3] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;eraser&apos;) {
                tempArray[i] = [&apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;);\n&apos; + &apos;context.lineTo(&apos; + point[2] + &apos;, &apos; + point[3] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;line&apos;) {
                tempArray[i] = [&apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;);\n&apos; + &apos;context.lineTo(&apos; + point[2] + &apos;, &apos; + point[3] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;text&apos;) {
                tempArray[i] = [&apos;context.fillText(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;, &apos; + point[2] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;arc&apos;) {
                tempArray[i] = [&apos;context.beginPath(); \n&apos; + &apos;context.arc(&apos; + toFixed(point[0]) + &apos;,&apos; + toFixed(point[1]) + &apos;,&apos; + toFixed(point[2]) + &apos;,&apos; + toFixed(point[3]) + &apos;, 0,&apos; + point[4] + &apos;); \n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;rect&apos;) {
                tempArray[i] = [this.strokeOrFill(p[2]) + &apos;\n&apos; + &apos;context.strokeRect(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;,&apos; + point[2] + &apos;,&apos; + point[3] + &apos;);\n&apos; + &apos;context.fillRect(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;,&apos; + point[2] + &apos;,&apos; + point[3] + &apos;);&apos;];
            }

            if (p[0] === &apos;quadratic&apos;) {
                tempArray[i] = [&apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;);\n&apos; + &apos;context.quadraticCurveTo(&apos; + point[2] + &apos;, &apos; + point[3] + &apos;, &apos; + point[4] + &apos;, &apos; + point[5] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

            if (p[0] === &apos;bezier&apos;) {
                tempArray[i] = [&apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + point[0] + &apos;, &apos; + point[1] + &apos;);\n&apos; + &apos;context.bezierCurveTo(&apos; + point[2] + &apos;, &apos; + point[3] + &apos;, &apos; + point[4] + &apos;, &apos; + point[5] + &apos;, &apos; + point[6] + &apos;, &apos; + point[7] + &apos;);\n&apos; + this.strokeOrFill(p[2])];
            }

        }
        textarea.value = tempArray.join(&apos;\n\n&apos;) + this.strokeFillText;

        this.prevProps = null;
    },


    relativeShortened: function(toFixed, getPoint) {
        var i = 0,
            point, p, length = points.length,
            output = &apos;&apos;,
            x = 0,
            y = 0;

        for (i; i &lt; length; i++) {
            p = points[i];
            point = p[1];

            if (i === 0) {
                x = point[0];
                y = point[1];
            }

            if (p[0] === &apos;text&apos;) {
                x = point[1];
                y = point[2];
            }

            if (p[0] === &apos;pencil&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;eraser&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;line&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;text&apos;) {
                output += this.shortenHelper(p[0], [
                    point[0],
                    getPoint(point[1], x, &apos;x&apos;),
                    getPoint(point[2], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;arc&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    point[2],
                    point[3],
                    point[4]
                ], p[2]);
            }

            if (p[0] === &apos;rect&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;quadratic&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;),
                    getPoint(point[4], x, &apos;x&apos;),
                    getPoint(point[5], y, &apos;y&apos;)
                ], p[2]);
            }

            if (p[0] === &apos;bezier&apos;) {
                output += this.shortenHelper(p[0], [
                    getPoint(point[0], x, &apos;x&apos;),
                    getPoint(point[1], y, &apos;y&apos;),
                    getPoint(point[2], x, &apos;x&apos;),
                    getPoint(point[3], y, &apos;y&apos;),
                    getPoint(point[4], x, &apos;x&apos;),
                    getPoint(point[5], y, &apos;y&apos;),
                    getPoint(point[6], x, &apos;x&apos;),
                    getPoint(point[7], y, &apos;y&apos;)
                ], p[2]);
            }
        }

        output = output.substr(0, output.length - 2);
        textarea.value = &apos;var x = &apos; + x + &apos;, y = &apos; + y + &apos;, points = [&apos; + output + &apos;], length = points.length, point, p, i = 0;\n\n&apos; + this.forLoop;

        this.prevProps = null;
    },


    relativeNOTShortened: function(toFixed, getPoint) {
        var i, point, p, length = points.length,
            output = &apos;&apos;,
            x = 0,
            y = 0;

        for (i = 0; i &lt; length; i++) {
            p = points[i];
            point = p[1];

            if (i === 0) {
                x = point[0];
                y = point[1];

                if (p[0] === &apos;text&apos;) {
                    x = point[1];
                    y = point[2];
                }

                output = &apos;var x = &apos; + x + &apos;, y = &apos; + y + &apos;;\n\n&apos;;
            }

            if (p[0] === &apos;arc&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.arc(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;, &apos; + point[2] + &apos;, &apos; + point[3] + &apos;, 0, &apos; + point[4] + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;pencil&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.lineTo(&apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;eraser&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.lineTo(&apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;line&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.lineTo(&apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;text&apos;) {
                output += &apos;context.fillText(&apos; + point[0] + &apos;, &apos; + getPoint(point[1], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[2], y, &apos;y&apos;) + &apos;);\n&apos; + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;rect&apos;) {
                output += this.strokeOrFill(p[2]) + &apos;\n&apos; + &apos;context.strokeRect(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;, &apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.fillRect(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;, &apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;);&apos;;
            }

            if (p[0] === &apos;quadratic&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.quadraticCurveTo(&apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;, &apos; + getPoint(point[4], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[5], y, &apos;y&apos;) + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (p[0] === &apos;bezier&apos;) {
                output += &apos;context.beginPath();\n&apos; + &apos;context.moveTo(&apos; + getPoint(point[0], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[1], y, &apos;y&apos;) + &apos;);\n&apos; + &apos;context.bezierCurveTo(&apos; + getPoint(point[2], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[3], y, &apos;y&apos;) + &apos;, &apos; + getPoint(point[4], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[5], y, &apos;y&apos;) + &apos;, &apos; + getPoint(point[6], x, &apos;x&apos;) + &apos;, &apos; + getPoint(point[7], y, &apos;y&apos;) + &apos;);\n&apos;

                + this.strokeOrFill(p[2]);
            }

            if (i !== length - 1) output += &apos;\n\n&apos;;
        }
        textarea.value = output + this.strokeFillText;

        this.prevProps = null;
    },



    forLoop: &apos;for(i; i &lt; length; i++) {\n&apos; + &apos;\t p = points[i];\n&apos; + &apos;\t point = p[1];\n&apos; + &apos;\t context.beginPath();\n\n&apos;

   
        + &apos;\t if(p[2]) { \n&apos; + &apos;\t\t context.lineWidth = p[2][0];\n&apos; + &apos;\t\t context.strokeStyle = p[2][1];\n&apos; + &apos;\t\t context.fillStyle = p[2][2];\n&apos;

        + &apos;\t\t context.globalAlpha = p[2][3];\n&apos; + &apos;\t\t context.globalCompositeOperation = p[2][4];\n&apos; + &apos;\t\t context.lineCap = p[2][5];\n&apos; + &apos;\t\t context.lineJoin = p[2][6];\n&apos; + &apos;\t\t context.font = p[2][7];\n&apos; + &apos;\t }\n\n&apos;

    
        + &apos;\t if(p[0] === &quot;line&quot;) { \n&apos; + &apos;\t\t context.moveTo(point[0], point[1]);\n&apos; + &apos;\t\t context.lineTo(point[2], point[3]);\n&apos; + &apos;\t }\n\n&apos;

   
        + &apos;\t if(p[0] === &quot;pencil&quot;) { \n&apos; + &apos;\t\t context.moveTo(point[0], point[1]);\n&apos; + &apos;\t\t context.lineTo(point[2], point[3]);\n&apos; + &apos;\t }\n\n&apos;

    
        + &apos;\t if(p[0] === &quot;text&quot;) { \n&apos; + &apos;\t\t context.fillText(point[0], point[1], point[2]);\n&apos; + &apos;\t }\n\n&apos;


        + &apos;\t if(p[0] === &quot;eraser&quot;) { \n&apos; + &apos;\t\t context.moveTo(point[0], point[1]);\n&apos; + &apos;\t\t context.lineTo(point[2], point[3]);\n&apos; + &apos;\t }\n\n&apos;


        + &apos;\t if(p[0] === &quot;arc&quot;) context.arc(point[0], point[1], point[2], point[3], 0, point[4]); \n\n&apos;

        + &apos;\t if(p[0] === &quot;rect&quot;) {\n&apos; + &apos;\t\t context.strokeRect(point[0], point[1], point[2], point[3]);\n&apos; + &apos;\t\t context.fillRect(point[0], point[1], point[2], point[3]);\n&apos;

        + &apos;\t }\n\n&apos;

        + &apos;\t if(p[0] === &quot;quadratic&quot;) {\n&apos; + &apos;\t\t context.moveTo(point[0], point[1]);\n&apos; + &apos;\t\t context.quadraticCurveTo(point[2], point[3], point[4], point[5]);\n&apos; + &apos;\t }\n\n&apos;

        + &apos;\t if(p[0] === &quot;bezier&quot;) {\n&apos; + &apos;\t\t context.moveTo(point[0], point[1]);\n&apos; + &apos;\t\t context.bezierCurveTo(point[2], point[3], point[4], point[5], point[6], point[7]);\n&apos; + &apos;\t }\n\n&apos;

        + &apos;\t context.stroke();\n&apos; + &apos;\t context.fill();\n&apos;

        + &apos;}&apos;,

    strokeFillText: &apos;\n\nfunction strokeOrFill(lineWidth, strokeStyle, fillStyle, globalAlpha, globalCompositeOperation, lineCap, lineJoin, font) { \n&apos; + &apos;\t if(lineWidth) { \n&apos; + &apos;\t\t context.globalAlpha = globalAlpha;\n&apos; + &apos;\t\t context.globalCompositeOperation = globalCompositeOperation;\n&apos; + &apos;\t\t context.lineCap = lineCap;\n&apos; + &apos;\t\t context.lineJoin = lineJoin;\n&apos;

        + &apos;\t\t context.lineWidth = lineWidth;\n&apos; + &apos;\t\t context.strokeStyle = strokeStyle;\n&apos; + &apos;\t\t context.fillStyle = fillStyle;\n&apos; + &apos;\t\t context.font = font;\n&apos; + &apos;\t } \n\n&apos;

        + &apos;\t context.stroke();\n&apos; + &apos;\t context.fill();\n&apos;

        + &apos;}&apos;,


    strokeOrFill: function(p) {
        if (!this.prevProps || this.prevProps !== p.join(&apos;,&apos;)) {
            this.prevProps = p.join(&apos;,&apos;);

            return &apos;strokeOrFill(&quot;&apos; + p.join(&apos;&quot;, &quot;&apos;) + &apos;&quot;);&apos;;
        }

        return &apos;strokeOrFill();&apos;;
    },


    prevProps: null,
    shortenHelper: function(name, p1, p2) {
        var result = &apos;[&quot;&apos; + name + &apos;&quot;, [&apos; + p1.join(&apos;, &apos;) + &apos;]&apos;;

        if (!this.prevProps || this.prevProps !== p2.join(&apos;,&apos;)) {
            this.prevProps = p2.join(&apos;,&apos;);
            result += &apos;, [&quot;&apos; + p2.join(&apos;&quot;, &quot;&apos;) + &apos;&quot;]&apos;;
        }

        return result + &apos;], &apos;;
    }

};

// -------------------------------------------------------------

function endLastPath() {
    var cache = is;

    if (cache.isArc) arcHandler.end();
    else if (cache.isQuadraticCurve) quadraticHandler.end();
    else if (cache.isBezierCurve) bezierHandler.end();

    drawHelper.redraw();
}

// -------------------------------------------------------------

var copiedStuff = [],
    isControlKeyPressed;

// -------------------------------------------------------------

function copy() {
    endLastPath();

    dragHelper.global.startingIndex = 0;

    if (find(&apos;copy-last&apos;).checked) {
        copiedStuff = points[points.length - 1];
        setSelection(find(&apos;drag-last-path&apos;), &apos;DragLastPath&apos;);
    } else {
        copiedStuff = points;
        setSelection(find(&apos;drag-all-paths&apos;), &apos;DragAllPaths&apos;);
    }
}

// -------------------------------------------------------------

function paste() {
    endLastPath();

    dragHelper.global.startingIndex = 0;

    if (find(&apos;copy-last&apos;).checked) {
        points[points.length] = copiedStuff;

        dragHelper.global = {
            prevX: 0,
            prevY: 0,
            startingIndex: points.length - 1
        };

        dragHelper.dragAllPaths(0, 0);
        setSelection(find(&apos;drag-last-path&apos;), &apos;DragLastPath&apos;);
    } else {

        dragHelper.global.startingIndex = points.length;
        points = points.concat(copiedStuff);
        setSelection(find(&apos;drag-all-paths&apos;), &apos;DragAllPaths&apos;);
    }
}

// -------------------------------------------------------------

</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
